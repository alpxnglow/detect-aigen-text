import os
import torch
from torch import nn
from torch.utils.data import DataLoader, Dataset
from transformers import BertTokenizer, BertModel, get_linear_schedule_with_warmup
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score, classification_report
import pandas as pd
from pathlib import Path
from datetime import datetime
from transformers import AutoModel

### CONSTANTS ###
INPUT_FILE = "data/testing_data.csv"
NUM_CLASSES = 2
MAX_LENGTH = 512
BATCH_SIZE = 16
HOME_DIR = str(Path.home())
MODEL_INPUT_DIR = os.path.join(HOME_DIR, "Documents", "Model", "Final")
MODEL_PATH = os.path.join(MODEL_INPUT_DIR, "ai_human_essay_classifier.pth")
BERT_MODEL_NAME = 'bert-base-uncased'

### GENERIC METHODS ###
# Read data
def load_essay_data(data_file):
    df = pd.read_csv(data_file)
    df = df.dropna()
    texts = df['essay'].tolist()
    labels = [1 if generated == 1 else 0 for generated in df['generated'].tolist()]
    print("Analyzing...")
    return texts, labels

# Text classification dataset class
class TextClassificationDataset(Dataset):
    def __init__(self, texts, labels, tokenizer, max_length):
        self.texts = texts
        self.labels = labels
        self.tokenizer = tokenizer
        self.max_length = max_length
    def __len__(self):
        return len(self.texts)
    def __getitem__(self, idx):
        text = self.texts[idx]
        label = self.labels[idx]
        encoding = self.tokenizer(text, return_tensors='pt', max_length=self.max_length, padding='max_length', truncation=True)
        return {'input_ids': encoding['input_ids'].flatten(), 'attention_mask': encoding['attention_mask'].flatten(), 'label': torch.tensor(label)}

# BERT classifier class
class BERTClassifier(nn.Module):
    def __init__(self, bert_model_name, num_classes):
        super(BERTClassifier, self).__init__()
        self.bert = BertModel.from_pretrained(bert_model_name)
        self.dropout = nn.Dropout(0.1)
        self.fc = nn.Linear(self.bert.config.hidden_size, num_classes)
    def forward(self, input_ids, attention_mask):
        outputs = self.bert(input_ids=input_ids, attention_mask=attention_mask)
        pooled_output = outputs.pooler_output
        x = self.dropout(pooled_output)
        logits = self.fc(x)
        return logits

# Inference run on sample instance
def predict_generated(text, model, tokenizer, device, max_length=128):
    model.eval()
    encoding = tokenizer(text, return_tensors='pt', max_length=max_length, padding='max_length', truncation=True)
    input_ids = encoding['input_ids'].to(device)
    attention_mask = encoding['attention_mask'].to(device)
    with torch.no_grad():
        outputs = model(input_ids=input_ids, attention_mask=attention_mask)
        _, preds = torch.max(outputs, dim=1)
    return "AI-generated text detected" if preds.item() == 1 else "This is human-written text."

### MAIN ###
# Read the data file
texts, labels = load_essay_data(INPUT_FILE)

# Initialize tokenizer, dataset, and data loader
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
model = BERTClassifier(BERT_MODEL_NAME, NUM_CLASSES).to(device)
model.load_state_dict(torch.load(MODEL_PATH))
model.eval()
tokenizer = BertTokenizer.from_pretrained(BERT_MODEL_NAME)
val_dataset = TextClassificationDataset(texts, labels, tokenizer, MAX_LENGTH)
val_dataloader = DataLoader(val_dataset, batch_size=BATCH_SIZE)

# Evaluate the model’s performance
# Test generated prediction
test_text = """In Julia Alvarez’s In the Time of the Butterflies, most perceive Minerva as the most effective member of the revolution. However, it is actually Patria due to her forgiving nature and willingness to sacrifice pride for the greater good.
While Minerva’s actions are shaped by her prideful and stubborn character, Patria’s willingness to set aside her pride for the sake of the revolution is more beneficial for the revolution. For example, after receiving the note delivered by Margarita, Patria expresses her gratitude, “offering her [her] hand. Then I added the words I found hard to wrench from my prideful heart. ‘Patria Mercedes, to serve you…’ [Patria] finally saw, all wise. He [God] was going to work several revolutions at one time. One of them would have to do with my pride” (209). In this passage, Patria begins to realize the role of pride in her revolutionary efforts; while initially harboring an immature resentment toward her half-sisters, this interaction prompts her realization that Margarita could be a help for the cause. This passage marks the beginning of Patria’s journey toward transcending her childish pridefulness for the greater purpose of the revolution. Minerva, on the other hand, consistently shows a different reaction to such opportunities. For example, after Peña suggested writing a letter of thanks to Trujillo, she expressed that she “was against it. Thank Trujillo for punishing us! ‘People look to us to be an example, we’ve got a responsibility!’ I spoke so fiercely, they looked a little sheepish… ‘Now, Minerva, ‘ Patria reasoned. ‘You know if he publishes the silly thing everyone will know why we wrote it.’” (261). Here, an instance of Minerva’s pride getting in the way of practical decision-making is seen. Even though writing the letter of thanks could logically yield more objective, useful results such as freeing the men from prison, Minerva upholds her idealistic principles of being an example for the people. Faithful to her character, Patria responds pragmatically, reassuring Minerva that the people would understand “why [they] wrote it.” This illustrates Patria’s logical and practical way of approaching things, willing to sacrifice pride for tangible results and making her a more productive, effective member of the revolution. Conversely, Minerva’s commitment to her principles, while admirable in its own right, often becomes a barrier to rational decision-making.
 	Additionally, Patria's forgiving nature and unique ability to empathize with her oppressors allow her to indirectly gain the support of Peña for the revolution. While pleading with Peña to get Nelson pardoned, Patria had a sudden realization: “This devil might seem powerful, but finally, I had a power stronger than his… Loading up my heart with prayer, I aimed it at the lost soul before me… Soften his devil’s heart, oh Lord. And then, I said the difficult thing, For he, too, is one of your children.” (216). In this passage, Patria demonstrates how she ties her faith to her extraordinary ability to feel forgiveness for even the most corrupt figures like Peña. Forgiveness, particularly in the face of oppression or injustice, demands an immense amount of strength and emotional intelligence. It involves a conscious decision to let go of resentment, anger, and desire for retaliation. This mental shift required immense maturity from Patria– a maturity not fully shown by Minerva in her revolutionary pursuits. Later in the scene, while still praying for Peña, the “ devil [she] was so used to seeing disappeared, and for a moment… I saw an overgrown fat boy, ashamed of himself… bowing my head, I did not want to be pushy… ‘Can you offer me any hope?’ ‘It’s in the works,’ he said… ‘I’ll let you know what I find out.’ ‘¡Gracias, ay, muchas gracias!’’ I kept saying” (217). Where Minerva may have reacted in a defiant manner true to her character, Patria uses her maturity and tact, aware of her lack of power. She strategically adopts a passive stance, recognizing Peña as another opportunity to further the revolution. Patria manages to subtly sway Peña's disposition, eventually leading to Nelson's release. Again, this showcases Patria's ability to achieve practical, effective outcomes through her calculated approach, contrasting with Minerva's more defiant character and method of fighting the revolution."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"1. {generated}")

# Test generated prediction
test_text = """The experiment aimed to investigate conjugation and recombination in Esherichia coli and determine the chromosomal order of a number of genes for amino acid synthesis and sugar metabolism. This was carried out by mixing donor and recipient strains and at certain time intervals interrupting the mating and plating on selective media. Qualitative assessment of the plates was then used to map the gene order. The chromosomal gene order was found to be thr, arg and xyl, ilv, leu, pro, his (see discussion for explanation of gene names).

Introduction: Bacterial DNA can be exchanged between different strains allowing new allele combinations to be produced. This means that a 'wild type' gene can be passed to a strain with a mutation in this gene and through recombination the gene activity can be restored. The most common mechanisms of genetic exchange are transformation, transduction and conjugation. In each case genetic material is transferred from the donor strain to the recipient strain and this is assessed by monitoring a change in phenotype of the recipient. This is usually carried out by arranging growth conditions to select for recipients that have received the genetic material as in bacteria the change is normally in a requirement for an amino acid, nucleotide or vitamin, and ability to use a compound as an energy source or a resistance to an antibacterial agent. Here conjugation will be looked at. This involves cell-cell contact between donor and recipient achieved through an F pilus (a protein appendage) synthesized by the donor and used to anchor the recipient to form a mating pair (or mating aggregate). Here conjugation will be investigated in Escherichia coli. In E. coli conjugation involves the F factor, which is present in the donor but not recipient strain (F-). This experiment involves conjugation between an Hfr (high frequency recombination - the F factor is integrated into the chromosome) strain, the donor, and a F- strain, the recipient. The E. coli chromosome is circular and transfer always starts from the same point, the F factor integration site, which allows time of entry mapping to be carried out: As soon as the two strains are mixed mating aggregates will form and transfer of the chromosome will start from a fixed site and in a fixed orientation. If the mating pairs are physically interrupted at intervals, mapping the time of entry of genes from the donor into the recipient can create a genetic map of the chromosome. The aim of the experiment was to understand these concepts and methods of bacterial genetics by exchanging pieces of E. coli chromosome between different strains by the process of conjugation and using a non-quantitative method to establish the order of some genes relating to amino acid metabolism and sugar catabolism.

Method: The experiment was carried out as laid out in the lab manual with the following detail. The donor strain used was E. coli KL14 (thi-1 Hfr KL14) The bacteria donor and recipient strains were allowed to grow in the shaking water bath at 37 oC for 120 minutes before being mixed together.

Results: From the results it is clear that the bacteria could grow earlier on some plates than others. In this case the sample selective media lacking threonine (Plate 6) grew first at time 0minutes (but also had growth on the recipient strain area), then on both plates lacking arginine (plate 1) and with xylose as the sugar (plate 7) at 15 minutes. The sample on plate 3, lacking isoleucine and valine was next to grow then plate 4 lacking leucine at 30 minutes. Plate 5 lacking proline showed growth at 60 minutes and finally plate 2 lacking histidine at 120minutes. The E. coli chromosomal gene order was determined to be: thr, arg and xyl, ilv, leu, pro, his.

Discussion: From the table of results it is clear that the genes allowing growth to occur by transferring the wild type allele were transferred at different time points for each gene selected. This is due to the process of Hfr conjugation discussed previously in which the chromosome is passed into the recipient in a certain order. As the mating pairs were disrupted at the time intervals given above no further gene transfer could take place in that particular sample and the sample would only grow on a selective plate if the gene allowing synthesis of that particular amino acid or metabolism of the sugar had already been passed into the recipient strain. It was therefore clear that by looking at the time points at which the samples started growing on different plates it was possible to map the order in which the genes had been transferred from the Hfr strain and hence the order in which they are present on the chromosome. Both plate 1 and 7 (lacking arginine and with xylose) showed growth at 15mins and had roughly the same amount of growth at this time and following times. It can therefore be concluded that these genes transferred at times fairly close together between 0 and 15 minutes and are therefore likely to be fairly close together on the chromosome. Plates 3 and 4 (lacking isoleucine/valine and leucine respectively) both showed growth for the first time on the sample plated at 30minutes. However Plate 3 showed more growth at the next sample at 60 minutes (+++) compared to plate 4 (++) and therefore it was concluded that the isoleucine/valine gene would have been the one transferred first probably nearer to the start of the time period (ie. 15minutes) Plate 6, lacking threonine appears to have growth at time 0 and much growth (+ +) at 15 minutes. However this plate also shows growth of the recipient strain alone. This could be due to the mutation in the recipient reverting to the wild type. This is only possible in a point-mutation - a deletion cannot revert as the DNA is missing completely. The mutation in the threonine coding gene in the recipient strain is known to not be a deletion (see materials list in lab manual) and therefore this reversion in possible. This would then invalidate the results for this plate, as this growth does not represent gene transfer. However the growth on plate 6 does still appear to show a gradation increasing at 15 minutes and 30 minutes and therefore there is still a high chance that this is an early gene. Taking all this into account an approximate order of gene transfer from the Hfr strain to the recipient can therefore be determined as follows: thr, arg and xyl, ilv, leu, pro, his. Where thr = gene coding for threonine, arg = gene coding for arginine, xyl = gene involved in xylose metabolism, ilv = gene coding for isoleucine and valine, leu = gene coding for leucine, pro = gene coding for proline, his = gene coding for histidine. Possible sources of errors in this experiment include the risk of dislodging the mating pairs by causing shaking or jarring whilst removing samples. This would have led to no further gene transfer in the bacteria concerned and hence errors to the results as growth may not have occurred at a time point in which it would have otherwise. The time at which the genes appeared to be transferred was determined by plating onto selective media. It was necessary to not only select for the recombinant (the recipient after it has received genetic material) but also against the donor. This is known as counter selection and here was carried out by including nalidixic acid in the medium as this prevents donor growth but not the recipient. Nalidixic acid will also prevent further gene transfer. If it was not included the donor strain would also grow on the selective media and all samples would show growth at all times due to the presence of the donor. The procedure and accuracy of results could be improved by using a quantitative approach in which the number of recombinant colonies are counted at each time point using a viable count. In conclusion the rough mapping of gene order along the E. coli chromosome can be determined qualitatively by physically interrupting mating pairs of a donor and recipient E. coli strain at certain intervals and noting growth levels after plating on selective media. This highlights the basic concepts and methods of conjugation and recombination in bacteria. 
"""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"2. {generated}")

test_text = """Cars. Cars have been around since they became famous in the 1900s, when Henry Ford created and built the first ModelT. Cars have played a major role in our every day lives since then. But now, people are starting to question if limiting car usage would be a good thing. To me, limiting the use of cars might be a good thing to do.

In like matter of this, article, "In German Suburb, Life Goes On Without Cars," by Elizabeth Rosenthal states, how automobiles are the linchpin of suburbs, where middle class families from either Shanghai or Chicago tend to make their homes. Experts say how this is a huge impediment to current efforts to reduce greenhouse gas emissions from tailpipe. Passenger cars are responsible for 12 percent of greenhouse gas emissions in Europe...and up to 50 percent in some carintensive areas in the United States. Cars are the main reason for the greenhouse gas emissions because of a lot of people driving them around all the time getting where they need to go. Article, "Paris bans driving due to smog," by Robert Duffer says, how Paris, after days of nearrecord pollution, enforced a partial driving ban to clear the air of the global city. It also says, how on Monday, motorist with evennumbered license plates were ordered to leave their cars at home or be fined a 22euro fine 31. The same order would be applied to oddnumbered plates the following day. Cars are the reason for polluting entire cities like Paris. This shows how bad cars can be because, of all the pollution that they can cause to an entire city.

Likewise, in the article, "Carfree day is spinning into a big hit in Bogota," by Andrew Selsky says, how programs that's set to spread to other countries, millions of Columbians hiked, biked, skated, or took the bus to work during a carfree day, leaving streets of this capital city eerily devoid of traffic jams. It was the third straight year cars have been banned with only buses and taxis permitted for the Day Without Cars in the capital city of 7 million. People like the idea of having carfree days because, it allows them to lesson the pollution that cars put out of their exhaust from people driving all the time. The article also tells how parks and sports centers have bustled throughout the city uneven, pitted sidewalks have been replaced by broad, smooth sidewalks rushhour restrictions have dramatically cut traffic and new restaurants and upscale shopping districts have cropped up. Having no cars has been good for the country of Columbia because, it has aloud them to repair things that have needed repairs for a long time, traffic jams have gone down, and restaurants and shopping districts have popped up, all due to the fact of having less cars around.

In conclusion, the use of less cars and having carfree days, have had a big impact on the environment of cities because, it is cutting down the air pollution that the cars have majorly polluted, it has aloud countries like Columbia to repair sidewalks, and cut down traffic jams. Limiting the use of cars would be a good thing for America. So we should limit the use of cars by maybe riding a bike, or maybe walking somewhere that isn't that far from you and doesn't need the use of a car to get you there. To me, limiting the use of cars might be a good thing to do."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"3. {generated}")

test_text = """While many may argue for it, the Electoral College has proved to be an obsolete way of electing the President. It is, essentially, an indirect way for voters to choose their candidates, by voting for electors whose loyalty is not guaranteed. The Electoral College vote can override the popular vote, as seen in the 2000 Presidential Election. Some say that the Electoral College is a system worth keeping, because it provides a certain outcome and avoids runoff elections, yet these arguments are founded on little reason.

Undoubtedly outdated, this system is a catastrophe in the works, the 2000 election only a glimpse of the chaos that could result from the Electoral College. The disaster factor is a strong argument against the Electoral College. Consider 1960, when Louisiana segregationists came close to replacing Democratic electors with ones who wouldn't support Kennedy 11. Also along those lines, electors are bound by nothing but obligation to vote for the candidate of their party, and sometimes change their decision upon voting. Even if it only happens occasionally, it is yet another fault in this system.

Not only is the Electoral College irrational, it is also simply unfair. Each state can only cast a single vote, so the one representative in Wyoming, who represents only 500 thousand, would have as much say as California's 55 representatives, who represent 35 million voters 12. Other sources say a tie would be unlikely. However, in 1979 in Ohio, it would have only taken a few thousand voters to vote the other way 12. Because of the "winnertakeall" system, certain states are left untouched by candidates who know they won't win them. In 2000, certain states didn't even see the candidates, and didn't air campaign ads, denying voters of a chance to further favor or favor them 13.

It is simple, the Electoral College system is a turnoff for many voters, especially after the incident in 2000 when Al Gore won the popular vote but lost the electoral vote. Voters can be discouraged if they have no hope of carrying their state, like Democrats in Texas, or Republicans in Cali 23. Assuming that "Voters in presidential elections are people who want to express a political preference rather than people who think that a single vote may decide an election 23" is rather incorrect. Single votes could absolutely sway an election, as mentioned earlier. Relying on the popular vote may make a tie more likely, but it would free voters from an obsolete and untrustworthy system. Over 60 percent of voters oppose the Electoral College 9 which is enough to bring attention to these facts and, hopefully, address them before another controversial occurance.

The evidence is all layed out, mishaps and nearmishaps, an impending catastrophe all too possible for comfort, unfair to potential voters. The Electoral College doesn't deserve its defenders. 2000 proved it, the voters have spoken up, and it is indisputably irrational to continue to rely on it. The system has been around for a while, and it will stay in place for the next few years, most likely. However, because of the light now being shined on its faults, it could have a chance to be reformed for the better."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"4. {generated}")

test_text = """The development of feminist thought and action in Japan is distinct from that of its emergence in the West, more specifically within the United States and Britain. 
Though influenced by Western politics, the development of feminism in Japan was also initiated by numerous other social and political factors that affected the political climate at that specific time and place. 
Adherence to Confucian ideologies severely restricted women within Japanese society, as well as subordinating the working classes and those not owning property. 
A growing political awareness and imperialist competition later led to the struggle for social reform, of which women were arguably at the forefront. 
This essay will deal with such social and political factors as these to account for the development of feminism in Japan. 
The subordinate position of women within Japanese society came to be highlighted at the end of the nineteenth century, whereas previously notions of the 'natural inferiority of women'1 had been largely unchallenged. 
This had implications for the rights of women concerning property, marriage and divorce, amongst other issues. 
Adopting Chinese Confucian ethics, the Japanese sought to uphold and promote to younger generations the established patriarchy through regulating the autonomy and independence of women. 
This was achieved through the establishment of a patrilineal family system that demanded filial respect within the family, which was then reflected in the necessity for obedience to the head of state.2 It can be observed from this that women were subject to conform to male ruling, both in familial terms and within the wider political sphere. 
This originated from the Confucian teaching that women were to be understood as yin, hence passive and in need of ruling by the male yang. 
This therefore left women no place to rule, either within the family or within the feudalistic structure prevailing in Japan at the time.3 Such oppression of female autonomy was further reinforced through the Civil Code of 1897, which successfully restricted women's power as it granted control of marital property and possessions to the husband, specifying that a wife could not act without her husband's permission.4 This subordination of Japanese women was only challenged after the re-ascendance of the Emperor Meiji in 1868, termed the Meiji Restoration (1868-1912). 
This signalled 'a process of reform, modernisation and democratisation'.5 From this point, widespread social and political reform took place within Japan, primarily to compete with Western imperialistic powers and assert a national strength. 
Western intellectuals linked the Japanese subordination of women to their weakness as a nation; a theory which was to be adopted by Japanese reformers such as those involved with the Meiji Six Journal, seeking to modernise and civilise their nation.6 It was seen as paramount to liberate women in society in order to 'gain international respectability for Japan'7 and thus to compete successfully in the global political economy. 
The Meiji Restoration was a more liberal form of government than had been in place previously and directly questioned the status of women, holding them to be 'at the centre of change' for reform of society and modernisation.8 It was arguably this revolution which made the woman question accessible to Japanese society, paving the way for women to make their own voices heard in the changing political context and thus providing a powerful medium for this oppressed section of society. 
During the struggle for women's liberation, nationalism gained increasing interest and received considerably more attention from Japanese intellectuals, reformers and citizens. 
Feminism and nationalism were interlinked in discourses on social reform, though many believed the latter to take precedence through exploiting the former for its own aims, observing how the state 'moulded women's options and energies into national rather than individual goals'.9 This may be explained in terms of Japan's increasing need to assert itself economically against Western capitalist structures, thus necessitating the mobilisation of the female half of the population, though this could only be achieved after their inclusion within the political sphere. 
However, the extent to which this was truly implemented is questionable. 
The fact that women were subordinate to men in Japanese society led many to suggest that this was the reason for Japan's economic and military weakness and consequent subordination as a nation to the West.10 Women were thus implicated in the development of a stronger nation and were relied upon heavily in new empire building. 
That is not to say that women were independent of the state, in fact the issue of support for mothers was highly debated. 
There existed, to some extent, interdependency between women and the state, though Yosano Akiko, a prominent feminist at the time, argued that 'it is slave morality for women to be dependent on men because of their procreational role [and therefore women] must refuse dependency on the state for the very same reason'.11 This serves to highlight the role assigned to women; primarily viewed as mothers providing the next generation of patriotic, nationalist fighters for the country. 
An additional factor affecting women was arguably their education. 
Debated by reformers, intellectuals and feminists, many continued to feel that this was a large 
barrier to women's struggle. 
It was observed that the 'inadequacy of women's education reinforced their low status'12 and was thus a cause for concern and in need of reform. 
In 1873, forty percent of boys and fifteen percent of girls attended primary school, though by 1910, nearly ninety nine percent of boys and ninety seven percent of girls were in this position.13 In 1885 the Minister of Education, Mori Arinori, a 'nationalist who said publicly that education was for the benefit of the state, not the individual'14 promoted the idea that women were to be educated for a purpose other than their own emancipation. 
This originated from the emphasis placed by the both state and traditional society on the need to produce good wives and wise mothers, or ryosai kembo.15 Hence, the limited education women received was aimed at developing their domestic and nurturing skills, rather than instilling them with intellectual desires and political awareness. 
The issue of political awareness and activity held the key to women's liberation in Japan. 
Though reformist ideologies became increasingly more popular, legislation remained highly conservative, reflected in laws such as the 1890 Peace Preservation Law regulating 'subversive activities', a move largely aimed at feminists, and also within laws preventing women from attending political meetings.16 However, with the reinstatement of the Emperor Meiji there was a shift towards democracy, which led women, as well as other oppressed groups, to question their position in society and to reject 'taxation without representation'.17 The growth of capitalism and the erosion of the feudalistic power structure supported the expansion of the middle class; a new group demanding more political rights and voicing their oppression through the right-wing People's Rights Movement, established in 1874. 
By 1878 the Movement had expanded membership to women, recognising them as 'a force to be mobilised', whereas they had previously been unconcerned with women's rights.18 Within a few years, Kishida Toshiko spoke at a public meeting on women's rights; the first woman to do so within the Movement. 
This signified a large step forward in women's liberation and inspired numerous other women to act, including Fukuda Hideko.19 Other notable groups formed due to the feeling within the middle classes that there was not sufficient political freedom and representation. 
For example, the Tokyo Women's Reform Society was set up chiefly by middle class Christians and campaigned largely against social evils oppressing women, such as prostitution and concubinage.20 
Due to rapid industrialisation taking place in Japan as an attempt to keep up with Western capitalism and the newly-introduced free trade market, there ensued an influx of women into the labour force. 
Whilst in 1930 there were ten million female workers in Japan, by 1944 this figure had increased to thirteen million, as well as showing a marked decrease in the percentage of men in the workforce.21 Women gradually entered such professions as teaching, nursing and clerical work, thus providing a strong basis for the working women's movement. 
However, women soon began to rise up against oppressive working conditions and laws, resulting in a strike in the Amamiya Silk Mill in Kofu. 
Here, as in other strikes taking place, women workers protested against worsening conditions of employment, wage decreases and abuse from male employers.22 Such dissatisfaction stemmed principally from the exploitative way in which female labour was being harnessed, so that industries 'could be made competitive in world markets if they were able to utilise cheap female labour'23 in order to then generate capital for use in other investments. 
A growing awareness of unfair working conditions led to a proliferation of working women's trade unions, thus granting improved representation and a medium through which they could make themselves heard in the rapidly modernising and industrialising nation. 
A further medium through which women gained representation was via the Seito journal, first published in 1911 by a women's literary appreciation group.24 Though not originally intended as a political group, it soon developed into such due to increasing pressure from the government to terminate its publication; feared as a threat to patriarchy and Japanese tradition. 
Eventually, the journal and members of the 'Bluestockings' group, such as Hiratsuka Raicho, came to question women's issues such as maternity provision, equal pay, the family system and marriage. 
The group demonstrably made the personal political and engaged many middle class Japanese women with the issue of their subordination, causing the government to enforce its termination in 1916.25 
Ultimately, it can be seen that a varied combination of changing social and political factors led to the development of feminism in Japan. 
Through increased political awareness and changing structures within the government, women were able to challenge their position for the first time. 
In the national struggle for increased economic and military power, gender identities were redefined in order to benefit the state. 
Women were arguably used in this process before being liberated themselves. 
Thereby, 'in the process of refusing subordinate status [as a nation], Japan constructed a new womanhood as a demonstration of its equality with the West and as a means of proving its civilised status'.26 It was this use of women for national goals that led to increased feelings of oppression and eventual action against exploitation and subordination, resulting in a strong feminist movement in Japan towards the end of the nineteenth century."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"5. {generated}")

test_text = """Mandatory vaccination policies have been a subject of ongoing debate in recent years. While some argue that these policies infringe upon personal freedoms, the overwhelming evidence from medical experts supports their implementation. Mandatory vaccination policies are crucial for safeguarding public health, preventing the spread of deadly diseases, and protecting vulnerable populations.

First and foremost, mandatory vaccination policies are essential for maintaining public health. Vaccines have been proven to be highly effective in preventing the spread of infectious diseases. According to the Centers for Disease Control and Prevention (CDC), vaccines have significantly decreased the incidence of diseases such as measles, polio, and hepatitis B in the United States. By ensuring a high vaccination rate within a population, mandatory policies help create herd immunity, reducing the overall risk of disease transmission. This is especially important for individuals who cannot be vaccinated due to medical reasons, such as those with weakened immune systems or allergies to vaccine components.

Moreover, mandatory vaccination policies play a crucial role in preventing outbreaks of deadly diseases. The recent resurgence of measles cases in several countries serves as a stark reminder of the potential consequences of low vaccination rates. Measles, a highly contagious and potentially fatal disease, can easily spread in communities where vaccination rates are low. In fact, the World Health Organization (WHO) reports that measles cases have increased globally by 300% in recent years, largely due to undervaccination. By mandating vaccinations, governments can effectively limit the spread of diseases and protect their populations from needless suffering and loss of life.

Furthermore, mandatory vaccination policies are vital for protecting vulnerable populations. Infants, the elderly, and individuals with compromised immune systems are particularly susceptible to the complications and severe consequences of vaccine-preventable diseases. By ensuring high vaccination rates, governments can create a protective barrier around these vulnerable populations, reducing their risk of exposure to potentially life-threatening illnesses. In this way, mandating vaccines demonstrates society's commitment to safeguarding the health and well-being of all its members.

Critics of mandatory vaccination policies often argue that these policies infringe upon personal freedoms and parental rights. However, it is important to remember that individual choices and actions can have far-reaching consequences for others. The decision not to vaccinate not only places the unvaccinated individual at risk but also exposes the broader community to potential outbreaks. Personal freedoms must be balanced against the collective responsibility to protect public health. Mandatory vaccination policies strike this necessary balance by encouraging individual responsibility while prioritizing the common good.

In conclusion, mandatory vaccination policies are crucial for maintaining public health, preventing outbreaks of deadly diseases, and protecting vulnerable populations. The overwhelming consensus among medical experts supports these policies as an effective means of reducing disease transmission and ensuring the well-being of communities. While personal freedoms are important, they must be balanced with the collective responsibility to protect public health. By implementing and enforcing these policies, governments can make significant strides towards safeguarding the health and safety of their populations."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"6. {generated}")

test_text = """With the advancement of medical science, vaccines have played a vital role in preventing the spread of infectious diseases. However, the issue of mandatory vaccination policies has become a controversial topic. While some argue that individuals should have the freedom to decide whether or not to vaccinate themselves and their children, it is important to consider the data and expert opinions from the medical field that strongly support the implementation of mandatory vaccination policies.

One of the main arguments in favor of mandatory vaccination is the concept of herd immunity. When a significant percentage of a population is immunized against a particular disease, it creates a protective barrier that limits the spread of the disease. This is especially important for individuals who are unable to receive vaccines due to medical conditions. By vaccinating those who can, we are protecting vulnerable members of society who may be unable to defend themselves against infectious diseases.

Additionally, studies have shown that vaccines are highly effective in preventing the spread of diseases. For example, the measles vaccine has been proven to be 97% effective in preventing this highly contagious disease. By ensuring a high vaccination rate, we can effectively reduce the chances of outbreaks and epidemics.

Furthermore, experts in the medical field strongly support the implementation of mandatory vaccination policies. The Centers for Disease Control and Prevention (CDC) and the World Health Organization (WHO) recommend vaccination as one of the most effective ways to prevent the spread of infectious diseases. These organizations widely endorse and promote immunization as a public health measure.

In addition to the medical benefits, mandatory vaccination policies also have economic advantages. The cost of treating vaccine-preventable diseases is substantial, both for individuals and for the healthcare system as a whole. By implementing mandatory vaccination policies, we can reduce the economic burden associated with treating these diseases and allocate resources more effectively.

Despite the overwhelming evidence in favor of mandatory vaccination policies, some individuals argue that these policies infringe upon personal freedoms. While it is important to respect individual autonomy, it is equally important to consider the potential harm that can be caused by the spread of vaccine-preventable diseases. In cases where individual choices can potentially harm others, such as in the case of infectious diseases, it is necessary to prioritize the greater good.

In conclusion, mandatory vaccination policies are not only supported by data and expert opinions from the medical field, but they also promote the health and well-being of society as a whole. By ensuring a high vaccination rate, we can protect vulnerable members of society, prevent the spread of diseases, and reduce the economic burden associated with treating vaccine-preventable diseases. While individual freedoms are important, it is essential to consider the potential harm caused by the spread of infectious diseases and prioritize public health. Mandatory vaccination policies are a necessary step towards a healthier and safer society."""""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"7. {generated}")

test_text = """In today's society, the issue of mandatory vaccination policies is a divisive topic that stirs up passionate debates. While some argue that individual liberties should take precedence, it is crucial to consider the overwhelming evidence and expert opinions from the medical field. This essay will present arguments in favor of mandatory vaccination policies, highlighting the benefits they provide for public health and the protection of vulnerable populations.

One of the primary reasons to support mandatory vaccination policies is the undeniable impact they have on preventing the spread of contagious diseases. Vaccines are scientifically proven to lower the risk of contracting and transmitting infections. Take, for example, the measles outbreak that occurred in the United States in 2019. According to the Centers for Disease Control and Prevention (CDC), nearly all reported cases were individuals who were unvaccinated. This outbreak could have been prevented if vaccinations were mandatory, effectively reducing the threat to public health.

Additionally, mandatory vaccination policies safeguard those who cannot receive vaccines for medical reasons. Individuals with weakened immune systems, such as cancer patients undergoing chemotherapy or infants who are too young to be vaccinated, heavily rely on the concept of herd immunity. When a significant portion of the population is immunized, it creates a protective barrier, preventing the spread of diseases to those who are susceptible. By mandating vaccinations, we ensure that these vulnerable populations are protected, drastically reducing the chances of severe illness or even death.

Moreover, it is important to note that the medical community overwhelmingly supports mandatory vaccination policies. Organizations such as the World Health Organization (WHO), the American Academy of Pediatrics (AAP), and the CDC all advocate for widespread vaccination programs. These institutions have spent years studying and compiling data that demonstrate the safety and effectiveness of vaccines. Therefore, their recommendations should carry considerable weight when considering public health policies.

Critics of mandatory vaccination policies often argue that they infringe upon individual freedoms. However, it is crucial to recognize that personal freedoms have limits when they potentially harm others. In the case of vaccinations, failing to vaccinate not only puts oneself at risk but also jeopardizes the well-being of the larger community. By imposing mandatory vaccinations, we strike a balance between individual autonomy and the common good, prioritizing the health of all.

In conclusion, mandatory vaccination policies have proven to be an effective method for preventing the spread of contagious diseases and protecting vulnerable populations. The overwhelming evidence and support from expert medical opinions highlight the necessity of these policies for public health. It is imperative that we prioritize the well-being of society as a whole over personal freedoms, as the consequences of vaccine-preventable infections can be severe and even deadly. By implementing and upholding mandatory vaccination policies, we can ensure a healthier and safer future for everyone."""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"8. {generated}")

test_text = """My dear reader,

I, as a humble individual, strongly believe that mandatory vaccination policies are absolutely necessary to promote the well-being of our society and protect the health of individuals, especially the most vulnerable among us. By ensuring that everyone receives necessary vaccinations, we can significantly reduce the spread of dangerous pathogens and prevent the outbreak of devastating diseases.

Firstly, let us consider the overwhelming scientific evidence that supports the effectiveness of vaccines in preventing the spread of infectious diseases. Numerous studies conducted by renowned medical institutions have shown that vaccines are effective in preventing illness, hospitalization, and even death. For instance, a study published in the prestigious Journal of Infectious Diseases found that the measles vaccine prevented an estimated 31.8 million cases of measles and 4,200 deaths from the year 2000 to 2017 in the United States alone! The evidence is clear: vaccinations save lives and protect our communities.

Moreover, mandatory vaccination policies also help establish herd immunity, which is crucial in safeguarding the well-being of those individuals who cannot receive vaccines due to medical reasons. By ensuring that a significant proportion of the population is vaccinated, we create a protective barrier that prevents the easy transmission of diseases, effectively shielding those who are more susceptible to infection. This is especially important for individuals with compromised immune systems, infants too young to receive certain vaccines, and the elderly, who may be at greater risk of severe illness or complications. In essence, mandatory vaccination policies are a compassionate and necessary measure to protect the vulnerable members of our community.

However, there are those who argue against mandatory vaccination policies, claiming that they infringe upon personal freedoms and individual rights. While I understand the importance of personal autonomy, the health and safety of the community must also be considered. It is by balancing these rights and responsibilities that we can maintain a harmonious and healthy society. When one person chooses not to receive a vaccine, they not only put themselves at risk but also jeopardize the health of those around them. By making vaccination mandatory, we ensure that all individuals take responsibility for their role in preventing the spread of infectious diseases.

For this argument, it is only fitting to consider the opinion of esteemed medical experts. Dr. Anthony Fauci, Director of the U.S. National Institute of Allergy and Infectious Diseases, has stated, "Mandatory vaccination policies are crucial in protecting public health. They reduce the burden of disease and save countless lives." His expertise and experience leave no room for doubt regarding the efficacy of mandatory vaccination policies.

In conclusion, my dear reader, while we must respect personal freedoms and autonomy, we must also recognize the inherent responsibility we have to protect the health and well-being of our society. By implementing mandatory vaccination policies, we can effectively prevent the spread of dangerous diseases, save lives, and protect the vulnerable among us. It is crucial that we follow the guidance of medical experts and trust in the overwhelming evidence that supports the benefits of vaccination. Let us embrace this collective responsibility and work together to ensure a healthier future for all.

Yours faithfully,
[Your Name]"""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"9. {generated}")

test_text = """Automation is when machines do work instead of people. It's like having a robot friend who can do lots of things for you! But some people are worried because they think that automation might take away their jobs. That means they might not have work to do anymore. It's important to understand what this could mean for our future job markets.

Economic forecasts can help us predict what might happen. One report from the World Economic Forum says that robots and computers could replace around 75 million jobs by the year 2022. That's a big number! But the same report also says that automation could create around 133 million new jobs. So, it's not all bad news! We might lose some jobs, but we could also gain new ones.

Technological reports give us more details about how automation is changing different industries. For example, in the manufacturing industry, many jobs are done by machines now. Robots can do repetitive tasks faster and more accurately than humans. This means that some people who used to work in factories might not have jobs anymore. But at the same time, new jobs are being created because someone needs to design, build, and fix these machines.

Automation is also affecting other fields. In the transportation industry, self-driving cars and trucks are becoming more common. This could mean fewer jobs for drivers. But it's also creating opportunities for people to work on developing and maintaining this technology. And in the customer service industry, chatbots and virtual assistants are helping customers without the need for as many human workers.

So, while automation might change the job market, it doesn't mean that there won't be any jobs left for humans. It will just be different jobs. As machines become more capable, it's important for us to learn new skills that machines can't do as well. This might mean focusing on things like creativity, problem-solving, and emotional intelligence. These are the skills that make us uniquely human!

In conclusion, automation is changing our job markets. Some jobs might be replaced by machines, but new jobs will also be created. Economic forecasts and technological reports show that there is still a place for humans in the future of work. We need to adapt and learn new skills to stay relevant. The future is exciting, and we can embrace the changes that automation brings!"""
generated = predict_generated(test_text, model, tokenizer, device, MAX_LENGTH)
print(f"10. {generated}")
